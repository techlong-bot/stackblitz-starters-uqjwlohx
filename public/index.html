<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pionex Pro | Grid Trader</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* PIONEX / BINANCE PALETTE */
            --bg-body: #0b0e11;
            --bg-panel: #161a1e;
            --bg-input: #2b3139;
            --border-color: #252b36;
            --primary: #0d6efd;
            --green: #0ecb81;
            --red: #f6465d;
            --text-main: #eaecef;
            --text-muted: #848e9c;
            --hover: #2a2e36;
        }

        * { box-sizing: border-box; }
        
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-size: 13px;
        }

        /* --- 1. HEADER --- */
        .header {
            height: 50px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            flex-shrink: 0;
        }
        .logo-area { display: flex; align-items: center; gap: 10px; }
        .logo-text { font-weight: 700; font-size: 16px; letter-spacing: 0.5px; }
        .logo-badge { background: #3d4552; color: #fff; font-size: 10px; padding: 2px 6px; border-radius: 4px; }
        
        .wallet-display {
            background: var(--bg-input);
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: 600;
            display: flex;
            gap: 10px;
        }
        .wallet-label { color: var(--text-muted); font-weight: 400; }

        /* --- 2. MAIN LAYOUT GRID --- */
        .workspace {
            display: grid;
            grid-template-columns: 280px 1fr 320px; /* Sidebar - Chart - Controls */
            grid-template-rows: 1fr 250px; /* Top Section - Bottom Panel */
            flex: 1;
            overflow: hidden;
        }

        /* --- LEFT: MARKET SIDEBAR --- */
        .market-sidebar {
            grid-row: 1 / -1; /* Full height */
            background: var(--bg-panel);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }
        .search-box { padding: 10px; border-bottom: 1px solid var(--border-color); }
        .search-input {
            width: 100%;
            background: var(--bg-body);
            border: 1px solid var(--border-color);
            padding: 8px;
            color: white;
            border-radius: 4px;
            font-size: 12px;
        }
        .market-header {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            font-size: 11px;
            color: var(--text-muted);
            font-weight: 600;
        }
        .market-list { overflow-y: auto; flex: 1; }
        .market-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 12px;
            cursor: pointer;
            transition: 0.1s;
        }
        .market-item:hover { background: var(--hover); }
        .market-item.active { background: #2b3139; border-left: 3px solid var(--primary); }
        .coin-name { font-weight: 600; color: #d1d5da; }
        .coin-vol { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

        /* --- CENTER: CHART --- */
        .chart-section {
            grid-column: 2;
            grid-row: 1;
            background: var(--bg-body);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }
        .ticker-bar {
            height: 50px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            padding: 0 20px;
            gap: 20px;
            background: var(--bg-panel);
        }
        .ticker-price { font-size: 20px; font-weight: 600; color: var(--green); }
        .ticker-change { font-size: 12px; font-weight: 500; }

        /* --- BOTTOM: ORDERS PANEL --- */
        .orders-section {
            grid-column: 2;
            grid-row: 2;
            background: var(--bg-panel);
            border-top: 1px solid var(--border-color);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }
        .tabs { display: flex; border-bottom: 1px solid var(--border-color); background: #1e2329; }
        .tab-btn {
            padding: 10px 20px;
            cursor: pointer;
            color: var(--text-muted);
            font-weight: 600;
            border-top: 2px solid transparent;
        }
        .tab-btn.active {
            color: var(--primary);
            border-top: 2px solid var(--primary);
            background: var(--bg-panel);
        }
        
        /* ORDERS TABLE */
        .orders-table-container { flex: 1; overflow-y: auto; padding: 0; }
        .order-table { width: 100%; border-collapse: collapse; }
        .order-table th { 
            text-align: left; padding: 10px 15px; 
            color: var(--text-muted); font-size: 11px; font-weight: 600;
            background: #1e2329; position: sticky; top: 0;
        }
        .order-table td { 
            padding: 12px 15px; border-bottom: 1px solid var(--border-color); 
            font-size: 12px; color: var(--text-main);
        }
        .btn-stop {
            background: transparent; border: 1px solid var(--border-color);
            color: var(--text-muted); padding: 4px 10px; border-radius: 4px; cursor: pointer;
        }
        .btn-stop:hover { border-color: var(--red); color: var(--red); }

        /* --- RIGHT: CONTROLS --- */
        .control-sidebar {
            grid-column: 3;
            grid-row: 1 / -1;
            background: var(--bg-panel);
            display: flex;
            flex-direction: column;
        }
        .ctrl-header { padding: 15px; border-bottom: 1px solid var(--border-color); font-weight: 700; font-size: 14px; }
        
        .strategy-card {
            margin: 15px;
            padding: 15px;
            background: #1e2530;
            border: 1px solid #2e384d;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
        }
        .strategy-card:hover { border-color: var(--primary); }
        .ai-tag { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 2px 6px; border-radius: 3px; font-size: 10px; font-weight: 700; margin-left: 6px; }

        .form-area { padding: 0 15px; flex: 1; overflow-y: auto; }
        .input-group { margin-bottom: 15px; }
        .input-label { display: block; color: var(--text-muted); font-size: 11px; margin-bottom: 6px; }
        .input-field {
            width: 100%;
            background: var(--bg-body);
            border: 1px solid var(--border-color);
            padding: 10px;
            border-radius: 4px;
            color: white;
            font-family: inherit;
        }
        .input-field:focus { border-color: var(--primary); outline: none; }

        .btn-create {
            width: 100%;
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px;
            font-weight: 700;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 14px;
        }
        .btn-create:hover { background: #0b5ed7; }

        /* UTILS */
        .text-green { color: var(--green); }
        .text-red { color: var(--red); }
        .flex-between { display: flex; justify-content: space-between; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-body); }
        ::-webkit-scrollbar-thumb { background: #3d4552; border-radius: 3px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo-area">
            <span class="logo-text">PIONEX</span>
            <span class="logo-badge">PRO</span>
        </div>
        <div class="wallet-display">
            <span class="wallet-label">Available:</span>
            <span id="walletBal">$10,000.00</span>
        </div>
    </div>

    <div class="workspace">

        <div class="market-sidebar">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="Search Coin">
            </div>
            <div class="market-header">
                <span>Pair</span>
                <span>Price</span>
            </div>
            <div id="coinList" class="market-list">
                </div>
        </div>

        <div class="chart-section">
            <div class="ticker-bar">
                <div style="font-size: 18px; font-weight:700" id="chartSymbol">BTC/USDT</div>
                <div class="ticker-price" id="chartPrice">--</div>
                <div class="ticker-change" id="chartChange">--%</div>
            </div>
            <div id="tv_chart" style="flex:1; width:100%;"></div>
        </div>

        <div class="orders-section">
            <div class="tabs">
                <div class="tab-btn active">Running Bots (Paper)</div>
                <div class="tab-btn">History</div>
            </div>
            <div class="orders-table-container">
                <table class="order-table">
                    <thead>
                        <tr>
                            <th>Pair</th>
                            <th>Range</th>
                            <th>Invested</th>
                            <th>Grid Profit</th>
                            <th>Total PnL</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="botList">
                        </tbody>
                </table>
            </div>
        </div>

        <div class="control-sidebar">
            <div class="ctrl-header">Create Grid Bot</div>
            
            <div class="strategy-card" onclick="autoFillAI()">
                <div class="flex-between">
                    <span style="font-weight:700; font-size:12px">AI Strategy <span class="ai-tag">AUTO</span></span>
                    <span class="text-green" style="font-weight:700; font-size:12px">~124% APR</span>
                </div>
                <div style="margin-top:8px; font-size:11px; color:var(--text-muted); line-height:1.5">
                    Price Range: <span id="aiRangeDisplay" style="color:var(--text-main)">...</span><br>
                    Grids: <span id="aiGridDisplay" style="color:var(--text-main)">...</span>
                </div>
            </div>

            <div class="form-area">
                <div class="input-group">
                    <label class="input-label">Lower Price</label>
                    <input type="number" id="inpLower" class="input-field" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label class="input-label">Upper Price</label>
                    <input type="number" id="inpUpper" class="input-field" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label class="input-label">Grids (2-200)</label>
                    <input type="number" id="inpGrids" class="input-field" placeholder="Quantity">
                </div>
                <div class="input-group">
                    <label class="input-label">Investment (USDT)</label>
                    <input type="number" id="inpInvest" class="input-field" placeholder="Amount > 10">
                </div>

                <div style="font-size:11px; color:var(--text-muted); margin-bottom:10px; text-align:center">
                    Simulated trading fee: 0.05%
                </div>

                <button class="btn-create" onclick="createBot()">CREATE BOT</button>
            </div>
        </div>

    </div>

    <script>
        // --- CONFIG ---
        const COINS = ["BTC", "ETH", "SOL", "BNB", "DOGE", "XRP", "ADA", "AVAX", "DOT", "MATIC"];
        let activeSym = "BTC";
        let prices = {};
        let wallet = 10000;
        let bots = [];
        let socket = null;

        // --- INIT ---
        function init() {
            renderMarketList();
            loadChart(activeSym);
            startStream();
            updateWallet();
            // Bot Loop
            setInterval(updateBots, 1000);
        }

        // --- UI RENDERERS ---
        function renderMarketList() {
            const list = document.getElementById('coinList');
            list.innerHTML = "";
            COINS.forEach(sym => {
                const item = document.createElement('div');
                item.className = `market-item ${sym === activeSym ? 'active' : ''}`;
                item.id = `item-${sym}`;
                item.onclick = () => switchCoin(sym);
                item.innerHTML = `
                    <div>
                        <div class="coin-name">${sym}/USDT</div>
                        <div class="coin-vol">Vol: ${(Math.random()*500).toFixed(1)}M</div>
                    </div>
                    <div style="text-align:right">
                        <div class="coin-name" id="p-${sym}">--</div>
                        <div class="coin-vol" id="c-${sym}">--</div>
                    </div>
                `;
                list.appendChild(item);
            });
            updateAIPreview();
        }

        function switchCoin(sym) {
            document.getElementById(`item-${activeSym}`).classList.remove('active');
            activeSym = sym;
            document.getElementById(`item-${activeSym}`).classList.add('active');
            
            document.getElementById('chartSymbol').innerText = `${sym}/USDT`;
            loadChart(sym);
            updateAIPreview();
        }

        function loadChart(sym) {
            document.getElementById('tv_chart').innerHTML = `<iframe src="https://s.tradingview.com/widgetembed/?frameElementId=tradingview_1&symbol=BINANCE:${sym}USDT&interval=15&hidesidetoolbar=1&symboledit=1&saveimage=0&toolbarbg=f1f3f6&studies=[]&theme=dark&style=1&timezone=Etc%2FUTC" style="width:100%; height:100%; border:none;"></iframe>`;
        }

        // --- DATA STREAM ---
        function startStream() {
            socket = new WebSocket('wss://stream.binance.com:9443/ws/!miniTicker@arr');
            socket.onmessage = (e) => {
                const data = JSON.parse(e.data);
                data.forEach(t => {
                    const s = t.s.replace('USDT','');
                    if(COINS.includes(s)) {
                        const p = parseFloat(t.c);
                        prices[s] = p;
                        
                        // Update List
                        const pEl = document.getElementById(`p-${s}`);
                        if(pEl) {
                            pEl.innerText = p.toFixed(p<1?4:2);
                            const cEl = document.getElementById(`c-${s}`);
                            cEl.innerText = `${parseFloat(t.P).toFixed(2)}%`;
                            cEl.style.color = parseFloat(t.P) >= 0 ? 'var(--green)' : 'var(--red)';
                        }

                        // Update Main Header
                        if(s === activeSym) {
                            const mainP = document.getElementById('chartPrice');
                            mainP.innerText = p.toFixed(p<1?4:2);
                            mainP.style.color = parseFloat(t.P) >= 0 ? 'var(--green)' : 'var(--red)';
                            document.getElementById('chartChange').innerText = `${parseFloat(t.P).toFixed(2)}%`;
                        }
                    }
                });
            };
        }

        // --- BOT LOGIC ---
        function getAIParams() {
            const p = prices[activeSym] || 0;
            if(!p) return null;
            return {
                lower: (p * 0.9).toFixed(p<1?4:2),
                upper: (p * 1.1).toFixed(p<1?4:2),
                grids: 20
            };
        }

        function updateAIPreview() {
            const params = getAIParams();
            if(params) {
                document.getElementById('aiRangeDisplay').innerText = `${params.lower} - ${params.upper}`;
                document.getElementById('aiGridDisplay').innerText = params.grids;
            } else {
                setTimeout(updateAIPreview, 1000);
            }
        }

        function autoFillAI() {
            const params = getAIParams();
            if(params) {
                document.getElementById('inpLower').value = params.lower;
                document.getElementById('inpUpper').value = params.upper;
                document.getElementById('inpGrids').value = params.grids;
                document.getElementById('inpInvest').value = 1000;
            }
        }

        function createBot() {
            const lower = parseFloat(document.getElementById('inpLower').value);
            const upper = parseFloat(document.getElementById('inpUpper').value);
            const invest = parseFloat(document.getElementById('inpInvest').value);
            
            if(!lower || !upper || !invest) return alert("Invalid inputs");
            if(invest > wallet) return alert("Insufficient funds");

            wallet -= invest;
            updateWallet();

            bots.push({
                id: Date.now(),
                pair: activeSym,
                entry: prices[activeSym],
                lower, upper, invest,
                gridProfit: 0
            });
            renderBots();
        }

        function updateBots() {
            // Simulating Grid Trading action
            bots.forEach(b => {
                if(Math.random() > 0.8) { // Random chance of grid fill
                    b.gridProfit += b.invest * 0.0002; // Small profit tick
                }
            });
            renderBots();
        }

        function stopBot(id) {
            const idx = bots.findIndex(b => b.id === id);
            if(idx === -1) return;
            const b = bots[idx];
            
            const curr = prices[b.pair];
            const pnl = (curr - b.entry) / b.entry * b.invest;
            const total = b.invest + pnl + b.gridProfit;
            
            wallet += total;
            updateWallet();
            bots.splice(idx, 1);
            renderBots();
        }

        function renderBots() {
            const list = document.getElementById('botList');
            list.innerHTML = "";
            bots.forEach(b => {
                const curr = prices[b.pair] || b.entry;
                const pnl = (curr - b.entry) / b.entry * b.invest;
                const total = pnl + b.gridProfit;
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="font-weight:bold">${b.pair}/USDT</td>
                    <td>${b.lower} - ${b.upper}</td>
                    <td>$${b.invest.toFixed(0)}</td>
                    <td class="text-green">+$${b.gridProfit.toFixed(4)}</td>
                    <td class="${total>=0?'text-green':'text-red'}">${total>=0?'+':''}$${total.toFixed(2)}</td>
                    <td><button class="btn-stop" onclick="stopBot(${b.id})">STOP</button></td>
                `;
                list.appendChild(tr);
            });
        }

        function updateWallet() {
            document.getElementById('walletBal').innerText = `$${wallet.toLocaleString(undefined, {minimumFractionDigits:2})}`;
        }

        init();
    </script>
</body>
</html>